```jsp
<script type="text/javascript">	
	// 컬럼 옵션
	var columnDefs = [
	    /*
	        [*_field, *_headerName, _align, _width],
	        [*_editable, _inputType[(select, check, radio, text("")), _data, _valueName, _textName], _required, _maskType(""(string), "number"), _maxLength("10.5", "5")],
	        _hide, _rowDrag, _lockColumn, _addClass
	
	        setColumn_New(
	            [ (*필드명), (*헤더명), (정렬), (너비) ],
	            [ (*편집여부), (입력종류(배열) [ (종류문자열), (데이터), (value컬럼명), (text컬럼명) ]), (필수여부), (마스크종류), (최대길이) ],
	            (숨김여부),
	            (row 드래그 여부),
	            (고정 여부),
	            (추가 클래스명)
	        )
	
	        (종류문자열) : "select", "check", "text"
	        (최대길이) : 문자열로 입력할 것
	    */
	    setColumn(["prdtGubn", "prdtGubn", "center", 130], [], true),
	    setColumn(["prdtUnit", "prdtUnit", "center", 130], [], true),
	    setColumn(["useYn", "useYn", "center", 130], [], true),
	    setColumn(["qrCode", "qrCode", "center", 130], [], true),
	    setColumn(["whGubn", "whGubn", "center", 130], [], true),
	    setColumn(["linkCode", "linkCode", "center", 130], [], true),
	    setColumn(["vendorCode", "vendorCode", "center", 100], [], true),
	    setColumn(["prdtRemark", "prdtRemark", "center", 100], [], true),
	    setColumn(["includeValue", "선택", "center", 50], [true, ["check"], false, "", "20"], false, false, false, ""),
	    setColumn(["prdtGubnName", "품목구분", "center", 100]),
	    setColumn(["prdtCode", "품번", "center", 120]),
	    setColumn(["prdtName", "품명", "left", 170]),
	    setColumn(["prdtSpec", "규격", "left", 170]),
	    setColumn(["prdtUnitName", "단위", "center", 65]),
	    setColumn(["prdtUprice", "판매단가", "right", 90]),
	    setColumn(["stockQty", "현재고", "right", 90]),
	    setColumn(["useYnName", "사용여부", "center", 70]),
	    setColumn(["modId", "수정자", "center", 95]),
	    setColumn(["modDt", "수정일시", "center", 140])
	];
	
	setColumnMask(columnDefs, "prdtUprice", "number");
	setColumnMask(columnDefs, "stockQty", "number");
	setColumnMask(columnDefs, "modDt", "datetime");
	
	// 컬럼 옵션
	var excelColumnDefs = [
		/*
			[*_field, *_headerName, _align, _width],
			[*_editable, _inputType[(select, check, radio, text("")), _data, _valueName, _textName], _required, _maskType(""(string), "number"), _maxLength("10.5", "5")],
			_hide, _rowDrag, _lockColumn, _addClass

			setColumn_New(
				[ (*필드명), (*헤더명), (정렬), (너비) ],
				[ (*편집여부), (입력종류(배열) [ (종류문자열), (데이터), (value컬럼명), (text컬럼명) ]), (필수여부), (마스크종류), (최대길이) ],
				(숨김여부),
				(row 드래그 여부),
				(고정 여부),
				(추가 클래스명)
			)

			(종류문자열) : "select", "check", "text"
			(최대길이) : 문자열로 입력할 것
		*/
		setColumn(["checkValue", "성공여부", "center", 70], [false, ["check"], false, "", "20", ""]),
		setColumn(["excelRow", "엑셀 행", "center", 65]),
		setColumn(["failRemark", "실패 사유", "left", 230]),
        setColumn(["linkCode", "품목연결코드", "left", 100], [true, [], true, "", "100", checkValueFunc]),
		setColumn(["prevPrdtGubn", "품목구분 입력값", "center", 110]),
		setColumn(["prdtGubn", "품목구분", "center", 90], [true, ["select", ${func:codeToJSON(pageContext, 'PRDT_GUBN')}, "value", "text"], false, "", "100", checkValueFunc]),
        setColumn(["prdtName", "품명", "left", 175], [true, [], true, "", "200", checkValueFunc]),
        setColumn(["prdtSpec", "규격", "left", 175], [true, [], true, "", "500", checkValueFunc]),
        setColumn(["prevPrdtUnit", "단위 입력값", "center", 85]),
		setColumn(["prdtUnit", "단위", "center", 55], [true, ["select", ${func:codeToJSON(pageContext, 'PRDT_UNIT')}, "value", "text"], false, "", "100", checkValueFunc]),
		setColumn(["prevStddValue", "품목기준값 입력값", "right", 120]),
		setColumn(["stddValue", "품목기준값", "right", 90], [true, [], true, "", "9", checkValueFunc]),
        setColumn(["prevWhGubn", "창고 입력값", "center", 100]),
        setColumn(["whGubn", "창고", "center", 80], [true, ["select", ${func:codeToJSON(pageContext, 'WH_GUBN')}, "value", "text"], true, "", "100", checkValueFunc]),
        setColumn(["prevVendorName", "매입처 입력값", "center", 110]),
		setColumn(["vendorCode", "매입처", "center", 90], [true, ["select", ${func:queryToJSON(pageContext, 'select.select_vendorInfo')}, "value", "text"], false, "", "100", checkValueFunc]),
		setColumn(["prdtRemark", "비고", "left", 90], [true, [], false, "", "1000", checkValueFunc]),
        setColumn(["prevUseYn", "사용여부 입력값", "center", 105]),
        setColumn(["useYn", "사용여부", "center", 80], [true, ["select", ${func:codeToJSON(pageContext, 'USE_YN')}, "value", "text"], true, "", "100", checkValueFunc])
	];
	
	setColumnMask(excelColumnDefs, "stddValue", "number", {maxLength : 9});
	
	// 그리드 옵션
	var _gridHelper = new initGrid(columnDefs, false);
	var gridOptions = _gridHelper.setGridOption();
	
	// 그리드 클릭 이벤트 추가
	_gridHelper.addRowClickEvent(gridRowClickEvent);

	var _excelGridHelper = new initGrid(excelColumnDefs, false);
	var excelGridOptions = _excelGridHelper.setGridOption();
	excelGridOptions.pagination = false;
	
	// 그리드 클릭 이벤트 발생시 수행할 함수
	function gridRowClickEvent(event) {
		$("#hPrdtCode").val(event.data.prdtCode);
		$("#prdtCode").val(event.data.prdtCode);
		$("#prdtName").val(event.data.prdtName);
		$("#prdtGubn").val(event.data.prdtGubn);
		$("#prdtSpec").val(event.data.prdtSpec);
		$("#prdtUnit").val(event.data.prdtUnit);
		$("#stddValue").val(event.data.stddValue);
		$("#whGubn").val(event.data.whGubn);
		$("#useYn").val(event.data.useYn);
		$("#linkCode").val(event.data.linkCode);
		$("#vendorName").val(event.data.vendorName);
		$("#vendorCode").val(event.data.vendorCode);
    	$("#prdtRemark").val(event.data.prdtRemark);
    	$("#stddValue").data("inputMasking").setValue(event.data.stddValue);
    	$("#stockQty").data("inputMasking").setValue(event.data.stockQty);
    	$("#prdtUprice").data("inputMasking").setValue(getValueCheck(event.data.prdtUprice, "string"));
	}

	function checkValueFunc(_obj) {
		const index = _obj[0].__selecetedRowIndex;
		const row = _obj[0].getGridRowData(index);
		const api = _obj[0].__gridOption.api;
		
		var failRemark = "";
		
		var totalCnt = 0;
		var successCnt = 0;
		var failCnt = 0;

		row.linkCode = row.linkCode.trim();
		row.prdtName = row.prdtName.trim();
		row.prdtSpec = row.prdtSpec.trim();
		
		if(row.linkCode == "" || row.linkCode == undefined){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "품목연결코드 입력 필요";
		} else if(row.linkCode.length > 100){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "품목연결코드 입력 길이 초과";
		} else{
     		for(var i = 0; i < index; i++){
     			if(_excelGridHelper.getAllGridData()[i].linkCode.toUpperCase() == row.linkCode.toUpperCase()){
     				if(failRemark != ""){
     					failRemark += ", ";	
     				}
     				failRemark += "중복 품목연결코드 존재";
     				break;
     			}
     		}
		}
		
		if(row.prdtName == "" || row.prdtName == undefined){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "품명 입력 필요";
		} else if(row.prdtName.length > 200){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "품명 입력 길이 초과";
		}
		
		if(row.prdtSpec == "" || row.prdtSpec == undefined){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "규격 입력 필요";
		} else if(row.prdtSpec.length > 500){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "규격 입력 길이 초과";
		}
		
		if(row.whGubn == "" || row.whGubn == undefined){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "창고 입력 필요";
		}
		
		if(row.useYn == "" || row.useYn == undefined){
			if(failRemark != ""){
				failRemark += ", ";	
			}
			failRemark += "사용여부 입력 필요";
		}
	
		if(row.stddValue == 0){
			_excelGridHelper.setGridData(index, "stddValue", "1", true);
		}
		
		if(failRemark != ""){
			_excelGridHelper.setGridData(index, "checkValue", "N", true);
			_excelGridHelper.setGridData(index, "failRemark", failRemark, true);
		} else{
			if(row.prdtName != "" && row.prdtSpec != "" && row.whGubn != ""
					&& row.linkCode != "" && row.useYn != ""){
					_excelGridHelper.setGridData(index, "checkValue", "Y", true);
					_excelGridHelper.setGridData(index, "failRemark", "", true);
			}	
		}	
		
		$.each(_excelGridHelper.getAllGridData(), function(idx, val) {
			totalCnt++;
			if(val.checkValue == "Y"){
				successCnt++;
			}else{
				failCnt++;
			}
		});
		
		 $("#total_cnt").text(totalCnt);
		 $("#success_cnt").text(successCnt);
		 $("#fail_cnt").text(failCnt);
	}
	
	function loadTableData(isMsg) {
		if (isMsg === undefined) isMsg = true;
		var frm = $("#frmMain");
		//---- 그리드 조회 시 필수요소 start
		frm.addParam("result", $("#myGrid")); // 그리드 태그
		frm.addParam("grid", "gridOptions"); // 그리드 옵션
		//---- 그리드 조회 시 필수요소 end
		frm.addParam("func", "IQ");
		frm.addParam("query_id", "stdd.prdtManage.select_list");
		frm.addParam("dataType", "json"); // 그리드 불러오는 타입 (기본 json)
		if (isMsg === false) {
			frm.addParam("afterAction", false);
		}
		frm.request();
	}

	function handleIQ(data, textStatus, jqXHR) {
		$(".card").eq(2).height($(".card").eq(1).height());
		clearData();
	}

	function saveData() {
		var frm = $("#frmMain2");
		frm.serializeArrayCustom();
		frm.addParam("func", "IS");
		frm.addParam("dataType", "json");
		frm.addParam("hPrdtCode", $("#hPrdtCode").val().trim());
		frm.setAction("<c:url value='/stdd/prdtSave.do' />");
		frm.request();
	}

	function handleIS(data, textStatus, jqXHR) {
		if(data.count > 0){
			$("#hPrdtCode").val("");
			loadTableData(false);
		}
	}

    function downExcelData() {
		var frm = $("#frmMain");
		frm.addInput("func", "IQ_Excel");
		frm.addInput("query_id", "stdd.prdtManage.select_excelList");
		frm.addInput("type", "prdt");
		frm.addInput("kPrdtGubnName", $("#kPrdtGubn option:selected").text());
		frm.addInput("kUseYnName", $("#kUseYn option:selected").text());
		frm.setAction("<c:url value='/common_excel.do'/>");
		frm.removeAttr("onsubmit");
		frm.submit();
		frm.setAction("<c:url value='/common_select.do'/>");
		removeExcelParam();
	}

	function handleIQ_Excel(data, textStatus, jqXHR) {}

	// 초기화
	function clearData() {
    	$("#frmMain2").formClear();
    	$("#stddValue").data("inputMasking").setValue("1");
    	$("#prdtUprice").data("inputMasking").setValue("0");
    	$("#stockQty").data("inputMasking").setValue("0");
        //$("#safeQty").data("inputMasking").setValue("1");
		$("#prdtCode").val("자동생성");
		$("#hPrdtCode").val("");
		gridOptions.api.deselectAll();
	}

	// 엑셀 변환
	function uploadFile() {
        var frm = $("#frmModal3");
    	frm.serializeArrayCustom();
    	frm.addParam("func", "IS_excel");
    	frm.addParam("dataType","json");
    	frm.addParam("ajaxType", "file");
    	frm.addParam("afterAction",false);
        frm.setAction('<c:url value="/stdd/prdtExcelUploadRegister.do" />');
		frm.request();
    }
	
	function handleIS_excel(data, textStatus, jqXHR) {
		if (data.length > 0) {
			notifySuccess("변환이 완료되었습니다.");
			var totalCnt = 0;
			var successCnt = 0;
			var failCnt = 0;
			
			$.each(data, function(idx, val) {
				totalCnt++;
				if(val.hasError == "T"){
					failCnt++;	
					val.checkValue = "N";
					val.failRemark = val.errorReason;
				}else{
					successCnt++;
					val.checkValue = "Y";
					val.failRemark = "";
				}
			});
			
			 $("#total_cnt").text(totalCnt);
			 $("#success_cnt").text(successCnt);
			 $("#fail_cnt").text(failCnt);
			 
			 $("#multiFiles").val("");
			 excelGridOptions.api.setRowData(data);
	         excelGridOptions.setOriginalData(data);
	         $("#modalExcel").modal("show");
		}else{
			notifyDanger("변환된 데이터가 존재하지 않습니다.\n엑셀파일을 확인해 주세요.");
			$("#multiFiles").val("");
			$("#fileName").val("");
		}
	}

    function saveExcelData() { 
    	var frm = $("#frmMain");
		frm.serializeArrayCustom();
		frm.addParam("func", "IS_excelSave");
	    frm.addParam("dataType", "json");
	    frm.addParam("grid", "excelGridOptions.all");
		frm.setAction("<c:url value='/stdd/prdtExcelSave.do' />");
		frm.addParam("dataType", "json");
		frm.request();
	}

    function handleIS_excelSave(data, textStatus, jqXHR){
    	if(data.count > 0) {
    		$("#multiFiles").val("");
    		$("#fileName").val("");
    		$("#modalExcel").modal("hide");
    		loadTableData();
        }
    }
		
	function validation(){
		if($("#prdtName").val().trim() == ""){
			notifyDanger("품명을 입력해 주세요.");
			return false;
		} else if($("#prdtSpec").val().trim() == ""){
			notifyDanger("규격을 입력해 주세요.");
			return false;
		} else if($("#stddValue").val().trim() == ""){
			notifyDanger("품목기준값을 입력해 주세요.");
			return false;
		} else if($("#whGubn").val() == ""){
			notifyDanger("창고를 선택해 주세요.");
			return false;
		} else if($("#linkCode").val() == ""){
			notifyDanger("품목연결코드를 입력해 주세요.");
			return false;
		} else if($("#vendorName").val().trim() != "" && $("#vendorCode").val() == ""){
			notifyDanger("매입처명을 입력하여 검색된 목록 중에서 매입처를 선택해 주세요.");
			return false;
		}
		$("#prdtName").val($("#prdtName").val().trim());
		$("#prdtSpec").val($("#prdtSpec").val().trim());
		return true;
	}
	
	$(function() {        
		var eGridDiv = document.querySelector("#myGrid");
		var gridObj1 = new agGrid.Grid(eGridDiv, gridOptions);
		var eGridDivExcel = document.querySelector("#excelGrid");
		new agGrid.Grid(eGridDivExcel, excelGridOptions);

	    // 그리드 툴 버튼 바로 표시
	    $("i.open-card-option").trigger("click");
	    
		// inputMasking
        $("#stddValue").inputMasking("number");
        $("#prdtUprice").inputMasking("number");
        $("#stockQty").inputMasking("number", {signed:true});
        //$("#safeQty").inputMasking("number");
		
		// 조회
		$("#btnSearch").click(function() {
			loadTableData();
		});

		// frmMain 자동조회
// 		$("#frmMain").autoSearch(loadTableData);
		$("#kPrdtGubn, #kPrdtName, #kPrdtSpec, #kUseYn").change(function(){
			loadTableData();
		});

	    //전체 선택
        $("#btnSelectAll").on("click", function(){
     		for(var i=0; i<_gridHelper.getAllGridData().length; i++){
     			_gridHelper.getAllGridData()[i].includeValue = "Y";
     		}
     		gridOptions.api.applyTransaction({});
     	});
     	
      	//전체 해제
        $("#btnDeselect").on("click", function(){
     		for(var i=0; i<_gridHelper.getAllGridData().length; i++){     			
     			_gridHelper.getAllGridData()[i].includeValue = "N";
     		}
     		gridOptions.api.applyTransaction({});
     	});
      	
		// 초기화
		$("#btnAdd").click(function() {
			clearData();
		});
		
		// 저장
		$("#btnSave").click(function() {
			if(validation()){
				if (confirm("저장하시겠습니까?")) {
					saveData();
				}
			}
		});

		// 품목기준값
		$("#stddValue").on("blur", function() {
		    if (this.value.trim() === "") {
		        $(this).val(1);
		    }
		    
		    if (Number(this.value) < 1) {
		    	$(this).val(1);
		    }
		});
		
		// QR 인쇄
		$("#btnQrPrint").click(function() {
			var bool = false;
    		var obj = _gridHelper.getAllGridData();
    		
    		for(var i = 0; i < obj.length; i++) {
    			if(obj[i]["includeValue"] == "Y"){
    				bool = true;
    			}
			}
			
			if(bool){
    			$("#modalPrint").modal("show");
    		}else{
    			notifyDanger("품목 리스트에 선택된 데이터가 없습니다.");
    		}
		});
		
        $("#btnQrTop, #btnQrSide").click(function() {
			$("#modalPrint").modal("hide");
			OpenPopupSingle("/stdd/prdtQrPrintPopup.do?gubn=" + $(this).data("gubn"), 840, 1000, "_prdtQrPrintPop");
        });
		
        $("#btnModalPrintClose").click(function() {
        	$("#modalPrint").modal("hide");
        });
		
     	// 엑셀 다운로드
        $("#btnExcel").click(function() {
        	downExcelData();
        });
		
		// 엑셀 업로드
		$("#btnExcelUpload").click(function() {
			$("#modalFile").modal("show");
		});
		
		// 양식 다운로드
        $("#btnExcelFormDownload").click(function() {
            window.open('<c:url value="/assets/excel/prdt/prdt_upload_form.xlsx" />');
        });

	 	$("#fileName, #btnUpload").click(function() {
			$("#multiFiles").trigger("click"); 
		}); 

		$("#multiFiles").change(function() {
            // 파일명
            $("#fileName").val($("#multiFiles")[0].files[0].name);
        });
		
		// 변환
	 	$("#btnExcelConvert").click(function() {
	 		if(document.getElementById("multiFiles").files.length < 1){
	 			notifyDanger("파일을 선택해 주세요.");
	 			return;
	 		} 

 			$("#modalFile").modal("hide");
			uploadFile();
       	});
		
        $("#btnModalFileClose").click(function() {
        	$("#modalFile").modal("hide");
        	$("#fileName").val("");
        	$("#multiFiles").val("");
        });

		// 업로드 품목 리스트 저장
		$("#btnExcelSave").click(function() {
			
			if(_excelGridHelper.getAllGridData().length < 1){
				if(document.getElementById("multiFiles").files.length < 1){
		 			notifyDanger("파일을 선택해 주세요.");
		 			return;
		 		}else{
		 			notifyDanger("업로드된 파일을 변환해 주세요.");
		 			return;
		 		}
			}
			
			var checkValue = false;
			var checkLinkCode = false;
			var checkPrdtName = false;
			var checkPrdtSpec = false;
			var checkWhGubn = false;
			var checkUseYn = false;
			
			for(var i=0; i<_excelGridHelper.getAllGridData().length; i++){
				if(_excelGridHelper.getAllGridData()[i].checkValue == "N"){
					checkValue = true;	
				}	
			}
			
			if(checkValue){
				notifyDanger("업로드 리스트에 실패한 데이터가 존재합니다. 실패 사유를 확인 후 데이터를 수정해 주세요.");
	 			return;
			}
			
			$.each(_excelGridHelper.getCheckedRows("checkValue"), function(idx, val) {
				if(val.linkCode === undefined || val.linkCode == ""){
					checkLinkCode = true;
				}
				if(val.prdtName === undefined || val.prdtName == ""){
					checkPrdtName = true;
				}
				
				if(val.prdtSpec === undefined || val.prdtSpec.trim() == ""){
					checkPrdtSpec = true;
				}
				
				if(val.whGubn === undefined || val.whGubn == ""){
					checkWhGubn = true;
				}
				
				if(val.useYn === undefined || val.useYn == ""){
					checkUseYn = true;
				}
			});
			
			if(checkLinkCode){
				notifyDanger("품목연결코드를 입력해 주세요.");
				return;
			} else if(checkPrdtName){
				notifyDanger("품명을 입력해 주세요.");
				return;
			} else if(checkPrdtSpec){
				notifyDanger("규격을 입력해 주세요.");
				return;
			} else if(checkWhGubn){
				notifyDanger("창고를 선택해 주세요.");
				return;
			} else if(checkUseYn){
				notifyDanger("사용여부를 선택해 주세요.");
				return;
			}
			
			if(confirm("해당 내용으로 업로드하시겠습니까?")){
				saveExcelData();	
			}
		});
		
		// 모달닫기
		$("#btnModalExcelClose").on("click", function() {
			$("#multiFiles").val("");
			$("#fileName").val("");
			excelGridOptions.api.setRowData([]);
	        excelGridOptions.setOriginalData([]);
	 		excelGridOptions.api.applyTransaction({});
			$("#modalExcel").modal("hide");
		});	
		
		loadTableData();
		
	});
</script>

<div class="page-body sub-body" style="position:relative; font-size: 0.9em;">
	<h3 class="sub_tit">품목관리</h3>
	<div class="row">
		<div id="search_all_wrapper">
			<card:button>
				<form:button type="Search" id="btnSearch" />
				<form:button type="Add" id="btnAdd"/>
				<form:button type="Save" id="btnSave" />
				<form:button type="Print" id="btnQrPrint" caption="QR 인쇄" className="d-none d-md-inline-block"/>
				<form:button type="Excel" id="btnExcel" caption="엑셀"/>
				<form:button type="Upload" id="btnExcelUpload" className="d-none d-md-inline-block"/>
			</card:button>
			<div class="col-12 top_search">
				<card:open title="검색조건" />
					<card:content />
					<div class="search-area col-lg-12" >
						<form id="frmMain" name="frmMain" method="post" onsubmit="return false" class="">
							<div class="search_cont">
								<form:input id="hPrdtCode" caption="hPrdtCode" type="hidden" />
								<form:select id="kPrdtGubn" caption="품목구분" all="true" allLabel="전체" queryId="#PRDT_GUBN" />
								<form:input id="kPrdtName" caption="품명" addAttr="maxlength='20'" />
								<form:input id="kPrdtSpec" caption="규격" addAttr="maxlength='20'" />
								<form:select id="kUseYn" caption="사용여부" all="true" allLabel="전체" queryId="#USE_YN" />
							</div>
						</form>
					</div>
				<card:close />
			</div>
		</div>
		<div class="col-xl-9 col-lg-9 col-md-9 col-sm-12 col-12">
			<card:open title="품목 리스트" contents="※ 버튼 정보<br>추가 : 신규 품목 등록을 위해 입력란을 초기화합니다. <br>저장 : 입력·수정한 품목정보를 저장합니다. <br>QR 인쇄 : 품목 리스트에서 선택한 품목의 QR코드를 인쇄합니다.<br>엑셀 : 조회 목록을 엑셀로 다운로드합니다. <br>업로드 : 엑셀 양식을 다운로드할 수 있고, 엑셀에 작성한 품목 목록을 저장합니다."/>
				<card:toolButton title="">
					<form:button type="IncludeAll" id="btnSelectAll" caption="전체선택" wrap="li"/>
		          	<form:button type="ExcludeAll" id="btnDeselect" caption="전체해제" wrap="li"/>
				</card:toolButton>
				<card:content />
				<form:grid id="myGrid" />
			<card:close />
		</div>
		<div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 col-12">
			<card:open title="품목정보" />
			<card:toolButton title="">
			</card:toolButton>
			<card:content /> 
				<form id="frmMain2" name="frmMain2" method="post" onsubmit="return false" class="">
					<label:input id="prdtCode" caption="품번" className="danger" size="12" value="자동생성" state="readonly" />  
					<label:input id="prdtName" caption="품명" className="danger" size="12" addAttr="maxlength='200'"/>
					<label:select id="prdtGubn" queryId="#PRDT_GUBN" caption="품목구분" all="true" allLabel="선택" size="12" />
					<label:input id="prdtSpec" caption="규격" size="12" value="" className="danger" addAttr="maxlength='500'"/>
					<label:select id="prdtUnit" queryId="#PRDT_UNIT" caption="단위" all="true" allLabel="선택" size="12"/>
					<label:input id="stddValue" caption="품목기준값" size="12" addAttr="maxlength='11'" className="danger" value='1' addClassName="text-right"/>
					<label:select id="whGubn" queryId="#WH_GUBN" caption="창고" all="true" allLabel="선택" size="12" className="danger"/>
					<%-- <label:input id="safeQty" caption="안전재고" size="12" addAttr="maxlength='11'"/> --%>
					<label:input id="linkCode" caption="품목연결코드" className="danger" size="12" addAttr="maxlength='100'"/>
					<label:input id="vendorName" caption="매입처" addAttr="maxlength='50'" type="autocomplete" code="vendorCode" queryId="autocomplete.select_vendorList" />
					<label:textarea id="prdtRemark" caption="비고" rows="2" addAttr="maxlength='1000'" size="12" className="text_box"/>
					<label:select id="useYn" queryId="#USE_YN" caption="사용여부" size="12" value="Y"/>
					<label:input id="prdtUprice" caption="판매단가" size="12" value="0" state="readonly" addClassName="text-right"/>  
					<label:input id="stockQty" caption="현재고" size="12" value="0" state="readonly" addClassName="text-right"/>  
				</form>
			<card:close />
		</div>
	</div>
</div>

<!-- QR 유형 선택 팝업 --> 
<div class="modal fade" id="modalPrint" tabindex="-1" role="dialog" aria-labelledby="modalPrint" style="position: fixed;" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog" role="document" style="max-width: 270px;">
		<div class="modal-content">
			<div class="modal-header"> 
				<h5 class="modal-title">인쇄 형식 선택</h5>
			</div> 
			<div class="modal-body new_sales">
				<div class="row">
					<div class="col-12">
						<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
							<div class="col-12 no-padding">
								<button type="button" id="btnQrTop" data-gubn="top" class="btn btn-sm waves-effect waves-light btn-primary btn-outline-primary default"> 
									세로 (4 X 6)
								</button>
								<button type="button" id="btnQrSide" data-gubn="side" class="btn btn-sm waves-effect waves-light btn-primary btn-outline-primary default"> 
									가로 (2 X 12)
								</button>
							</div>
						</div>
						<div class="col-12 text-right" style="margin-top:5px;">
							<form:button type="Close" id="btnModalPrintClose" />
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> 

<!-- 파일 업로드 모달 팝업 --> 
<div class="modal fade" id="modalFile" tabindex="-1" role="dialog" aria-labelledby="modalFile" style="position: fixed;" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog" role="document" style="max-width: 450px;">
		<div class="modal-content">
			<div class="modal-header"> 
				<h5 class="modal-title">파일 업로드</h5>
			</div> 
			<div class="modal-body new_sales">
				<div class="row">
					<div class="col-12">
						<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
							<div class="col-12 no-padding">
								<form id="frmModal3" name="frmModal3" method="post" onsubmit="return false" class="form-horizontal">			    
			                    	<input type="file" id="multiFiles" name="multiFiles" accept=".xls, .xlsx" class="w100p" style="display: none;">
						            <div class="form-group no-margin no-padding">
										<label class="control-label text-right" style="width:20% !important" id="dataLabel">파일선택</label>
										<div class="inputGroupContainer label-attached"> 
											<div class="input-group">
												<a href="/" id="filePath" download style="display: none;"></a>
												<input name="fileName" id="fileName" class="form-control" type="text" readonly="readonly" data-path="" style="font-weight:bold; cursor:pointer;">
												<span class="input-group-btn">
													<button type="button" id="btnUpload" name="btnUpload" class="btn btn-sm btn-secondary" style="line-height: 8px;">첨부/변경</button>
												</span>
											</div>
										</div>
									</div>
					            </form>
							</div>
						</div>
						<div class="col-6 text-left" style="margin-top:5px;">
							<button type="button" id="btnExcelFormDownload" class="btn btn-sm waves-effect waves-light btn-primary btn-outline-primary default"> 
							    <span class="icofont icofont-download-alt"></span> 
							    &nbsp;양식 다운로드
							</button>
						</div>
						<div class="col-6 text-right" style="margin-top:5px;">
							<form:button type="Upload" id="btnExcelConvert" className="d-none d-md-inline-block"/>
							<form:button type="Close" id="btnModalFileClose" />
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div> 

<!-- 엑셀 업로드 모달 팝업 -->
<div class="modal fade" id="modalExcel" tabindex="-1" role="dialog" aria-labelledby="modalEdit4" style="position: fixed;" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog" role="document" style="max-width: 1830px">
		<div class="modal-content">
			<div class="modal-body new_sales">
				<div class="row">
					<div class="col-12">
						<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
							<div class="col-12 no-padding">
								<card:open title="품목 업로드 리스트" />
									<card:content />
									<form:grid id="excelGrid" height="498px"/>
								<card:close />
							</div>
						</div>
						<div class="col-6 text-left" style="padding-left: 27px; font-size: 13px;">
							<span>총 </span>
							 <span id="total_cnt" style="color:#686565;"> </span>
							<span>/</span>
							<span>성공 </span>
							 <span id="success_cnt" style="color:#7373f6;"> </span>
							<span>/</span>
							<span>실패 </span>
							 <span id="fail_cnt" style="color:#ff7272;"> </span>
						</div>
						<div class="col-6 text-right">
							<form:button type="Save" id="btnExcelSave" />
                            <form:button type="Close" id="btnModalExcelClose" />
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<%@ include file="../../core/include/footer.jsp"%>

```